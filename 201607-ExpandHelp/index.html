<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>コロンブス日和 - ExpandHelp</title>
    <style type="text/css">
      body {
        background-color:#ffffff;
        font-size:12;
        font-family: "Hiragino Kaku Gothic ProN","メイリオ", "sans-serif";
      }
      a { text-decoration: none; }
      li.bold { font-weight: bold; }
      div.body { width:340pt; }
      div.left { float:left; width:10%; font-weight:bold;}
      div.right { width:50%;}
      h1 { background-color:#4d4; padding:8pt;}
    </style>
    <script type="text/javascript">
    setTimeout("location.reload()",1000*5);
    </script>

  </head>

  <body>
    <div class='body'>
      <h1>コロンブス日和 - ExpandHelp</h1>
      
      今回は、オンラインヘルプやマニュアルに関連するイライラを解決できる
      「ExpandHelp」というシステムを紹介します。
      
      <h2>ヘルプの憂鬱</h2>
      
      たいていの複雑なシステムにはオンラインヘルプやマニュアルが用意されているものですが、
      パソコンやアプリケーションの解説本が大量に売られているところを見ると、
      ヘルプやマニュアルは充分役にたってはいないようです。
      
      <p/>
      ヘルプが利用されない最大の理由は
      <b>必要な項目がみつからない</b>
      ことでしょう。
      
      たとえばMacを米国時間に設定したいと思って「米国時間」で検索すると
      下のような謎の項目が表示されます。
      
      <blockquote>
        <img src="https://gyazo.com/1d1f4a6f960405a4011cb9fa678e168d.png" width=250>
      </blockquote> 
      
      これではわけがわからないので
      「時間」で検索すると
      より多くの項目が表示されますが、
      米国時間の設定には関係なさそうです。
      
      <blockquote>
        <img src="https://gyazo.com/027aa92aeb12308cbc5ebfe608cc61b4.png" width=250>
      </blockquote>
      
      「時刻」や「時計」で検索すれば「「日付と時刻」環境設定」という項目が
      みつかりますが、これで米国時間に設定できるのかはよくわかりませんし、
      そもそも「米国時間」や「時間」でも検索できるべきではないでしょうか。
            
      <p/>
      必要な項目がみつかった場合でも、
      そこに記述されている方法は
      <b>自分で実行する</b>必要があります。
        
      ユーザはMacを米国時間に設定したいだけであり、
      時刻やタイムゾーンを設定する一般的な方法を知りたいわけではないのにもかかわらず、
      ヘルプシステムは一般的なやり方しか教えてくれませんから、
      ユーザは自分で環境設定パネルを開いて操作を行なう必要があります。
      
      <p/>
      このように、たいていのヘルプシステムは
      
      <ol>
        <li>ヘルプ項目がみつからない</li>
        <li>自分で操作が必要</li>
      </ol>
      
      という問題があるうえに、
      最近は普通にWeb検索すればそれなりに有用情報がみつかることが多いため、
      ヘルプシステムへの期待が無くなってしまっているのだと思われます。
      
      <h2>ExpandHelp</h2>
      
      Web検索に苦労することが少なくなってきたのは、
      検索エンジンの性能が向上したこともさることながら、
      情報の量がすごい勢いで増えてきたことによる影響も大きいでしょう。
      ブログなどに「Macの時計を米国時間に設定する方法」が書いてあれば、
      普通に「Mac 米国時間」で検索すればみつかります。      
      つまり、
      <b>様々な表現で情報が表現されていれば検索に成功する可能性が高くなる</b>
      といえるでしょう。
      
      <p/>
      Webで検索に成功した場合でも、
      記事を参照しながらユーザが自分で操作を行なう必要はあります。
      この手間をなくすには、
      <b>検索の意図に合致する操作をシステムが生成して実行できる</b>
      ようにすればよいでしょう。
      
      <p/>
      ExpandHelpは、
      どんな検索語からでもヘルプエントリがみつかるように
      様々な表現で内容を表現し、
      ユーザの要求をすぐ実行できるようにするシステムです。
      
      <h3>検索対象文字列の作成</h3>

      現在一般的な検索システムでWebやファイルを検索する場合、
      検索される側のデータは固定されているので、
      検索する側のクエリ文字列を工夫することによって
      検索を行なうのが常識になっています。
      たとえば
      「時間」というキーワードを使って
      米国時間に関連した情報の検索が失敗した場合は
      「時刻」や「タイムゾーン」のような別のキーワードで再検索を試みるのが普通でしょう。
      Web検索でもファイル検索でもこういう作業は常識になっているので
      これを特に面倒と思っていない人も多いかもしれません。
      
      しかし本当にユーザにとって便利なヘルプ情報を提供しようとするならば
      「米国時間にセット」でも「タイムゾーンを設定」でも情報が検索できるような
      データを用意しておく方が親切です。
      
      <p/>
      ヘルプデータの方であらかじめ様々な表現を用意しておけば、
      キーワードでの検索の成功率は上がるはずです。
      たとえばMacの環境設定の場合には
      「米国時間に設定」
      「英国時間にセット」
      「タイムゾーンの変更」
      のような文字列を検索対象として用意しておけばいいでしょう。
      
      <p/>
      このような様々な表現を人手ですべて用意することは現実的ではありませんが、
      「タイムゾーンを(米国|英国)(時間|時刻)に(設定|セット|変更)」
      のような正規表現を用意しておき、
      これを展開したあらゆる表現
      (タイムゾーンを米国時間に設定、タイムゾーンを米国時刻に設定, ...)
      に対して普通のキーワード検索を行なうことにすれば
      「米国時間」のような検索も成功するはずです。

      <p/>
      展開されたデータは巨大になってしまう可能性がありますが、
      最近のパソコンでは多少大きなデータを利用しても問題ありませんし、
      実装を工夫して実際に文字列を展開せずに検索を行なうこともできます。
      
      <h3>ヘルプ項目の実行</h3>
      
      「米国時間」でヘルプ検索に成功してユーザの意図どおりの結果が出た場合、
      ユーザの意図は正しく検索システムに伝わっていることになりますから、
      そのままシステムに実行を指示することができます。
      タイムゾーンを設定する<code>timezone</code>というコマンドが存在したとすると、
      ヘルプ文字列に対して
      
      <blockquote>
        <code>timezone $1</code>
      </blockquote>
      
      のようなコマンドパタンを登録しておいて「米国」のようなパラメタを
      代入して起動すればよいでしょう。
      
      <p/>
      「時刻を3:00に設定」のように任意の数字をパラメタとしたい場合は、
      検索パタン中の時刻パタンを抽出して「時刻パタン」という文字列に置き換えてから
      「(時間|時刻)を(時刻パタン)に(設定|セット)(する|したい)」
      のような正規表現を展開した文字列とマッチングを行ない、
      与えたられた時刻パタンを引数として
      <code>date</code>のようなコマンドを起動すればよいでしょう。
      
      <h2>ExpandHelp for Mac</h2>
      
      このような考えにもとづいて、
      Macの柔軟なヘルプシステム
      「ExpandHelp」を試作しました。
      ExpandHelpはMacのメニューバーに常駐するアプリケーションで、
      キーワードを入力するとそれに関連したヘルプが表示されます。
            
      <blockquote>
        <img src="http://gyazo.com/43d82e015388a040ce9b854ab064e60f.png" width=300>
      </blockquote>
      
      たとえば「3:45」と入力すると、
      3:45という時刻に関連するコマンドがメニューに表示されます。
      
      <blockquote>
        <img src="http://gyazo.com/c9c5cc8b59bb34c7867c19a0f55ef7d5.png" width=300>
      </blockquote>
      
      ここで「時刻を3:45にセットする」を選ぶと
      <code>date</code>コマンドが実行されて
      システムの時刻が3:45にセットされます。
      
      <p/>
      ExpandHelpのヘルプデータは以下のような配列として表現されています。
      
      <blockquote>
        <img src="http://gyazo.com/1e55a71c044a5121d51fdfe44e648feb.png" width=400>
      </blockquote>
      
      <code>(時計|時間|時刻)を(0|1|2|3|4|5|6|7|8|9|10|11|12):(0|1|2|3|4|5)(0|1|2|3|4|5|6|7|8|9)(AM|PM)に(セットする|設定する|あわせる)</code>
      を展開したパタンのうち<code>3:45</code>にマッチするものが表示され、
      選択すると
      <code>setdate(3,4,5)</code>
      が実行されます。
      
      <p/>
      ExpandHelpは面白いシステムなのですが、
      私が毎日使うようなものではないにもかかわらず
      ヘルプデータを用意するのが面倒なので
      結局あまり使わなくなってしまいました。
      
    </div>
  </body>
</html>

